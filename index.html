<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Couple Diary</title>
<style>
  :root{
    --coral:#ff8b7a;
    --navy:#2d3748;
    --soft:#faf9f8;
  }
  *{box-sizing:border-box}
  html,body{
    height:100%;
    margin:0;
    font-family:Inter, "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto;
    background:#fff;
    color:var(--navy);
  }

  .screen {
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(180deg,#fff,#fcfbfa);
  }

  .login-card {
    width:min(420px,92%);
    background:#fff;
    border-radius:14px;
    padding:28px;
    box-shadow:0 12px 40px rgba(39,49,64,0.06);
    text-align:center;
    animation:cardIn 0.45s ease;
  }
  @keyframes cardIn {
    from { opacity: 0; transform: translateY(14px) scale(.995); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .brand { font-size:20px; font-weight:700; color:var(--navy); margin-bottom:10px; }
  .heart { font-size:34px; display:block; margin:6px auto 10px; animation:heartPop 1.2s ease-in-out infinite alternate; }
  @keyframes heartPop { from { transform: scale(1); } to { transform: scale(1.08); } }

  .login-input {
    width:100%; padding:12px 14px; border-radius:10px; border:1px solid #e6e6e6;
    font-size:15px; outline:none; margin-bottom:10px;
  }
  .login-input:focus { box-shadow:0 4px 18px rgba(160,160,160,0.08); border-color:var(--coral); }

  .login-btn {
    background:var(--coral); color:#fff; border:none; padding:12px 18px;
    border-radius:10px; font-weight:600; cursor:pointer; font-size:15px;
  }

  #dashboard {
    position:fixed; inset:0;
    display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
    gap:18px; padding-top:28px; overflow:auto;
    background:#fff; opacity:0; pointer-events:none;
    transition:opacity .45s ease;
  }
  #dashboard.show { opacity:1; pointer-events:auto; }

  .topbar {
    width:min(1100px,95%);
    display:flex; justify-content:space-between; align-items:center;
  }
  .user-display { font-weight:600; color:var(--navy); }

  .logout-btn {
    background:transparent; border:1px solid var(--navy);
    color:var(--navy); padding:6px 10px; border-radius:8px;
    cursor:pointer; font-size:13px; font-weight:500;
    transition:all .2s ease;
  }
  .logout-btn:hover { background:var(--navy); color:#fff; }

  .grid {
    width:min(1100px,95%);
    display:flex; gap:16px; flex-wrap:wrap;
    justify-content:center; margin-top:6px;
  }

  .panel {
    background:#fff; border-radius:12px; padding:14px;
    box-shadow:0 8px 24px rgba(39,49,64,0.04);
    border:1px solid rgba(0,0,0,0.04);
    flex:1 1 300px; min-width:260px; max-width:420px;
  }
  .panel h3 { margin:0 0 8px 0; font-size:16px; color:var(--navy); }

  textarea {
    width:100%; min-height:88px; resize:vertical;
    border:1px solid #e6e6e6; border-radius:8px; padding:10px; font-size:14px;
  }

  .save-btn {
    margin-top:8px; background:var(--coral); color:#fff;
    border:none; padding:9px 12px; border-radius:8px; cursor:pointer; font-weight:600;
  }

  .log { margin-top:10px; display:flex; flex-direction:column; gap:8px; max-height:320px; overflow:auto; padding-right:6px; }
  .entry { background:#fbfbfb; padding:10px; border-radius:8px; font-size:14px; box-shadow:0 2px 6px rgba(0,0,0,0.03) }
  .meta { font-size:12px; color:#6b7280; margin-top:6px }

  .playlist-wrap { width:min(1100px,95%); margin-bottom:36px; }
  .playlist-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(210px,1fr)); gap:12px; }

  @media(max-width:860px){
    .grid{flex-direction:column; align-items:stretch; padding:12px;}
    .panel{max-width:100%;}
  }
</style>
</head>
<body>
  <div class="screen" id="loginScreen">
    <div class="login-card">
      <div class="heart">ü§ç</div>
      <div class="brand">Couple Diary</div>
      <input id="loginId" class="login-input" placeholder="ID ÏûÖÎ†• (SM0710 / CY0710)" />
      <button id="loginBtn" class="login-btn">Login</button>
      <div style="font-size:13px;color:#6b7280;margin-top:10px;">SM0710 = ÍπÄÏÜîÏùå (üñ§) ¬∑ CY0710 = ÏµúÏöîÏõê (üíô)</div>
    </div>
  </div>

  <main id="dashboard">
    <div class="topbar">
      <div id="dateDisplay" style="color:#6b7280"></div>
      <div style="display:flex;align-items:center;gap:10px;">
        <div class="user-display" id="userDisplay"></div>
        <button class="logout-btn" id="logoutBtn">Logout</button>
      </div>
    </div>

    <div class="grid">
      <section class="panel">
        <h3>üñ§ Today Log</h3>
        <textarea id="todayInput" placeholder="Ïò§ÎäòÏùò Í∏∞Î°ùÏùÑ ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî..."></textarea>
        <button id="saveToday" class="save-btn">Ï†ÄÏû•</button>
        <div class="log" id="todayList"></div>
      </section>

      <section class="panel">
        <h3>üì∏ Couple Photo (ÎçîÎ∏îÌÅ¥Î¶≠ ÏóÖÎ°úÎìú)</h3>
        <div id="photoBox" style="border-radius:10px;overflow:hidden;background:#f6f6f6;min-height:220px;display:flex;align-items:center;justify-content:center;cursor:pointer;">
          <img id="photoImg" src="https://via.placeholder.com/520x360?text=Couple+Photo" alt="couple" style="max-width:100%;height:auto;display:block;" />
        </div>
        <input type="file" id="photoFile" accept="image/*" style="display:none" />
      </section>

      <section class="panel">
        <h3>üíô Chat Log</h3>
        <textarea id="chatInput" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
        <button id="sendChat" class="save-btn">Î≥¥ÎÇ¥Í∏∞</button>
        <div class="log" id="chatList"></div>
      </section>
    </div>

    <div class="playlist-wrap">
      <input id="musicUrl" placeholder="YouTube ÎßÅÌÅ¨ ÏûÖÎ†•" style="width:80%;padding:10px;border-radius:8px;border:1px solid #e7e7e7" />
      <button id="addMusic" class="save-btn">Ï∂îÍ∞Ä</button>
      <div class="playlist-grid" id="playlistGrid"></div>
    </div>
  </main>

<script>
const loginScreen=document.getElementById('loginScreen');
const loginBtn=document.getElementById('loginBtn');
const loginId=document.getElementById('loginId');
const dashboard=document.getElementById('dashboard');
const logoutBtn=document.getElementById('logoutBtn');
const userDisplay=document.getElementById('userDisplay');
const dateDisplay=document.getElementById('dateDisplay');

function setDate(){
  const d=new Date();
  dateDisplay.textContent=`${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')}`;
}
setDate();

function timeNow(){
  const d=new Date();
  const hh=String(d.getHours()).padStart(2,'0');
  const mm=String(d.getMinutes()).padStart(2,'0');
  return `${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')} ${hh}:${mm}`;
}

function performLogin(){
  const id=loginId.value.trim();
  if(id!=='SM0710' && id!=='CY0710'){alert('Îì±Î°ùÎêòÏßÄ ÏïäÏùÄ IDÏûÖÎãàÎã§.');return;}
  const user=id==='SM0710'?{id,name:'ÍπÄÏÜîÏùå',heart:'üñ§'}:{id,name:'ÏµúÏöîÏõê',heart:'üíô'};
  localStorage.setItem('cd_current_user',JSON.stringify(user));
  userDisplay.textContent=`${user.name} ${user.heart}`;
  loginScreen.style.display='none';
  dashboard.classList.add('show');
  document.body.style.overflow='auto';
  // üí° Î°úÍ∑∏Ïù∏ ÏßÅÌõÑ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
  setTimeout(loadAll,150);
}
loginBtn.addEventListener('click',performLogin);
loginId.addEventListener('keypress',e=>{if(e.key==='Enter')performLogin();});

logoutBtn.addEventListener('click',()=>{
  if(!confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†Ïñ¥Ïöî?'))return;
  localStorage.removeItem('cd_current_user');
  dashboard.classList.remove('show');
  loginScreen.style.display='flex';
  loginId.value='';
  document.body.style.overflow='hidden';
});

const todayInput=document.getElementById('todayInput');
const saveToday=document.getElementById('saveToday');
const todayList=document.getElementById('todayList');
saveToday.onclick=()=>{
  const user=JSON.parse(localStorage.getItem('cd_current_user')||'{}');
  const txt=todayInput.value.trim(); if(!txt)return;
  const arr=JSON.parse(localStorage.getItem('cd_today')||'[]');
  arr.push({user:user.name,id:user.id,text:txt,time:timeNow()});
  localStorage.setItem('cd_today',JSON.stringify(arr));
  todayInput.value=''; renderToday();
};
function renderToday(){
  const arr=JSON.parse(localStorage.getItem('cd_today')||'[]');
  todayList.innerHTML='';
  arr.slice().reverse().forEach(it=>{
    todayList.innerHTML+=`<div class='entry'><strong>${it.user}</strong> <span class='meta'>${it.time}</span><div>${it.text}</div></div>`;
  });
}

const chatInput=document.getElementById('chatInput');
const sendChat=document.getElementById('sendChat');
const chatList=document.getElementById('chatList');
sendChat.onclick=()=>{
  const user=JSON.parse(localStorage.getItem('cd_current_user')||'{}');
  const txt=chatInput.value.trim(); if(!txt)return;
  const arr=JSON.parse(localStorage.getItem('cd_chat')||'[]');
  arr.push({user:user.name,id:user.id,text:txt,time:timeNow()});
  localStorage.setItem('cd_chat',JSON.stringify(arr));
  chatInput.value=''; renderChat();
};
function renderChat(){
  const arr=JSON.parse(localStorage.getItem('cd_chat')||'[]');
  chatList.innerHTML='';
  arr.slice().reverse().forEach(it=>{
    chatList.innerHTML+=`<div class='entry' style='text-align:right;'><strong>${it.user}</strong> <span class='meta'>${it.time}</span><div>${it.text}</div></div>`;
  });
}

const musicUrl=document.getElementById('musicUrl');
const addMusic=document.getElementById('addMusic');
const playlistGrid=document.getElementById('playlistGrid');
addMusic.onclick=()=>{
  const user=JSON.parse(localStorage.getItem('cd_current_user')||'{}');
  const url=musicUrl.value.trim(); if(!url)return;
  const arr=JSON.parse(localStorage.getItem('cd_playlist')||'[]');
  arr.push({url,by:user.name,time:timeNow()});
  localStorage.setItem('cd_playlist',JSON.stringify(arr));
  musicUrl.value=''; renderPlaylist();
};
function extractYouTubeId(url){const m=url.match(/(?:v=|\/)([0-9A-Za-z_-]{6,11})(?:[&?]|$)/);return m?m[1]:null;}
function renderPlaylist(){
  const arr=JSON.parse(localStorage.getItem('cd_playlist')||'[]');
  playlistGrid.innerHTML='';
  arr.slice().reverse().forEach(it=>{
    const vid=extractYouTubeId(it.url);
    playlistGrid.innerHTML+= vid ?
    `<div class='panel' style='padding:8px;'><div style='position:relative;padding-top:56.25%'><iframe src='https://www.youtube.com/embed/${vid}' style='position:absolute;inset:0;width:100%;height:100%;border:0;border-radius:8px' allowfullscreen></iframe></div><div class='meta'>by ${it.by} ‚Ä¢ ${it.time}</div></div>` :
    `<div class='meta'>ÏûòÎ™ªÎêú ÎßÅÌÅ¨</div>`;
  });
}

const photoBox=document.getElementById('photoBox');
const photoImg=document.getElementById('photoImg');
const photoFile=document.getElementById('photoFile');
photoBox.ondblclick=()=>photoFile.click();
photoFile.onchange=e=>{
  const f=e.target.files[0]; if(!f)return;
  const reader=new FileReader();
  reader.onload=()=>{localStorage.setItem('cd_photo',reader.result); photoImg.src=reader.result;};
  reader.readAsDataURL(f);
};
function loadPhoto(){const p=localStorage.getItem('cd_photo');if(p)photoImg.src=p;}

function loadAll(){renderToday();renderChat();renderPlaylist();loadPhoto();}

(function init(){
  const user=JSON.parse(localStorage.getItem('cd_current_user')||'null');
  if(user){userDisplay.textContent=`${user.name} ${user.heart}`;loginScreen.style.display='none';dashboard.classList.add('show');loadAll();}
  else{document.body.style.overflow='hidden';}
})();
</script>
</body>
</html>
